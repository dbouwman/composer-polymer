<link rel="import" href="../../bower_components/paper-spinner/paper-spinner.html">

<polymer-element name="composer-search-summary" attributes="searchEl, spinner, results">
  <template>
    <link rel="stylesheet" href="composer-search-summary.css">

    <paper-spinner id="spinner"></paper-spinner>
    <template if="{{results.data.length}}">
      <div>Showing <strong>{{results.data.length}}</strong> of <strong>{{results.metadata.stats.total_count}}</strong> matching <strong>{{results.metadata.query_parameters.q}}</strong>.</div>
    </template>
  </template>
  <script>
    (function () {
      'use strict';

      Polymer({

        searchEl: 'composer-search',
        spinner: true,

        ready: function () {
          var searchComponent = document.querySelector(this.searchEl);
          searchComponent.addEventListener('search-before-start', this.showLoading.bind(this));
          searchComponent.addEventListener('search-completed', this.handleResults.bind(this));
        },

        showLoading: function (evt) {
          if (this.spinner) {
            this.$.spinner.active = true;
          }
        },

        handleResults: function (evt) {
          this.results = evt.detail;
          setTimeout(function () { this.$.spinner.active = false; }.bind(this), 500);
        }
      });

    })();
  </script>
</polymer-element>
